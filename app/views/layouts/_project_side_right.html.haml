%aside.project-right
  - if content_for? :sidebar_all
    = render :sidebar_all
  - else
    - if content_for? :sidebar_top_block
      = yield :sidebar_top_block
    - else
      - if can? current_user, :write_project, @project
        %h4 Report
        %ul
          %li
            = link_to new_project_issue_path(@project), :title => "New Issue", :class => "" do 
              New Issue »
          %li
            = link_to new_project_merge_request_path(@project), :title => "New Merge Request", :class => "" do 
              New Merge Request »

    %h4
      Recent Projects:
    %ul
      - current_user.projects.order("id DESC").limit(5).each do |project|
        %li
          = link_to project_path(project) do
            = project.name

    %h4
      Recent Issues:
    %ul
      - current_user.assigned_issues.order("id DESC").limit(5).each do |issue|
        %li
          = link_to project_issue_path(issue.project, issue) do
            = truncate issue.title


    %h4
      Recent Requests:
    %ul
      - current_user.assigned_merge_requests.order("id DESC").limit(5).each do |issue|
        %li
          = link_to project_merge_request_path(issue.project, issue) do
            = truncate issue.title


