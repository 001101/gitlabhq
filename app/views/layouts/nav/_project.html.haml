%div{ class: container_class }
  - if current_user
    .controls
      %span.dropdown.project-settings-dropdown
        %a.dropdown-new.btn.btn-gray#project-settings-button{href: '#', 'data-toggle' => 'dropdown'}
          = icon('cog')
          = icon('angle-down')
        %ul.dropdown-menu.dropdown-menu-align-right
          - if @project.allowed_to_share_with_group?
            = nav_link(controller: :group_links) do
              = link_to namespace_project_group_links_path(@project.namespace, @project), title: "Groups" do
                %span
                  Groups
          = nav_link(controller: :deploy_keys) do
            = link_to namespace_project_deploy_keys_path(@project.namespace, @project), title: 'Deploy Keys' do
              %span
                Deploy Keys
          = nav_link(controller: :hooks) do
            = link_to namespace_project_hooks_path(@project.namespace, @project), title: 'Webhooks' do
              %span
                Webhooks
          = nav_link(controller: :services) do
            = link_to namespace_project_services_path(@project.namespace, @project), title: 'Services' do
              %span
                Services
          = nav_link(controller: :protected_branches) do
            = link_to namespace_project_protected_branches_path(@project.namespace, @project), title: 'Protected Branches' do
              %span
                Protected Branches

          - if @project.builds_enabled?
            = nav_link(controller: :runners) do
              = link_to namespace_project_runners_path(@project.namespace, @project), title: 'Runners' do
                %span
                  Runners
            = nav_link(controller: :variables) do
              = link_to namespace_project_variables_path(@project.namespace, @project), title: 'Variables' do
                %span
                  Variables
            = nav_link(controller: :triggers) do
              = link_to namespace_project_triggers_path(@project.namespace, @project), title: 'Triggers' do
                %span
                  Triggers
            = nav_link(controller: :badges) do
              = link_to namespace_project_badges_path(@project.namespace, @project), title: 'Badges' do
                %span
                  Badges

          - access = user_max_access_in_project(current_user.id, @project)
          - can_edit = can?(current_user, :admin_project, @project)
          - if access || can_edit
            %li.divider
            - if can_edit
              %li
                = link_to edit_project_path(@project) do
                  Edit Project
            - if access
              %li
                = link_to leave_namespace_project_project_members_path(@project.namespace, @project),
                  data: { confirm: leave_project_message(@project) }, method: :delete, title: 'Leave project' do
                  Leave Project


  %ul.nav-links
    = nav_link(path: 'projects#show', html_options: {class: 'home'}) do
      = link_to project_path(@project), title: 'Project', class: 'shortcuts-project' do
        = icon('bookmark fw')
        %span
          Project
    = nav_link(path: 'projects#activity') do
      = link_to activity_project_path(@project), title: 'Activity', class: 'shortcuts-project-activity' do
        = icon('dashboard fw')
        %span
          Activity
    - if project_nav_tab? :files
      = nav_link(controller: %w(tree blob blame edit_tree new_tree find_file)) do
        = link_to project_files_path(@project), title: 'Files',  class: 'shortcuts-tree' do
          = icon('files-o fw')
          %span
            Files

    - if project_nav_tab? :commits
      = nav_link(controller: %w(commit commits compare repositories tags branches releases network)) do
        = link_to project_commits_path(@project), title: 'Commits', class: 'shortcuts-commits' do
          = icon('history fw')
          %span
            Commits

    - if project_nav_tab? :builds
      = nav_link(controller: %w(builds)) do
        = link_to project_builds_path(@project), title: 'Builds', class: 'shortcuts-builds' do
          = icon('cubes fw')
          %span
            Builds
            %span.badge.count.builds_counter= number_with_delimiter(@project.builds.running_or_pending.count(:all))

    - if project_nav_tab? :graphs
      = nav_link(controller: %w(graphs)) do
        = link_to namespace_project_graph_path(@project.namespace, @project, current_ref), title: 'Graphs',  class: 'shortcuts-graphs' do
          = icon('area-chart fw')
          %span
            Graphs

    - if project_nav_tab? :milestones
      = nav_link(controller: :milestones) do
        = link_to namespace_project_milestones_path(@project.namespace, @project), title: 'Milestones' do
          = icon('clock-o fw')
          %span
            Milestones

    - if project_nav_tab? :issues
      = nav_link(controller: :issues) do
        = link_to url_for_project_issues(@project, only_path: true), title: 'Issues', class: 'shortcuts-issues' do
          = icon('exclamation-circle fw')
          %span
            Issues
            - if @project.default_issues_tracker?
              %span.badge.count.issue_counter= number_with_delimiter(@project.issues.visible_to_user(current_user).opened.count)

    - if project_nav_tab? :merge_requests
      = nav_link(controller: :merge_requests) do
        = link_to namespace_project_merge_requests_path(@project.namespace, @project), title: 'Merge Requests', class: 'shortcuts-merge_requests' do
          = icon('tasks fw')
          %span
            Merge Requests
            %span.badge.count.merge_counter= number_with_delimiter(@project.merge_requests.opened.count)

    - if project_nav_tab? :team
      = nav_link(controller: [:project_members, :teams]) do
        = link_to namespace_project_project_members_path(@project.namespace, @project), title: 'Members', class: 'team-tab tab' do
          = icon('users fw')
          %span
            Members

    - if project_nav_tab? :labels
      = nav_link(controller: :labels) do
        = link_to namespace_project_labels_path(@project.namespace, @project), title: 'Labels' do
          = icon('tags fw')
          %span
            Labels

    - if project_nav_tab? :wiki
      = nav_link(controller: :wikis) do
        = link_to get_project_wiki_path(@project), title: 'Wiki', class: 'shortcuts-wiki' do
          = icon('book fw')
          %span
            Wiki

    -#- if project_nav_tab? :forks
      = nav_link(controller: :forks, action: :index) do
        = link_to namespace_project_forks_path(@project.namespace, @project), title: 'Forks' do
          = icon('code-fork fw')
          %span
            Forks

    - if project_nav_tab? :snippets
      = nav_link(controller: :snippets) do
        = link_to namespace_project_snippets_path(@project.namespace, @project), title: 'Snippets', class: 'shortcuts-snippets' do
          = icon('clipboard fw')
          %span
            Snippets

    -#- if project_nav_tab? :settings
      = nav_link(html_options: {class: "#{project_tab_class} separate-item"}) do
        = link_to edit_project_path(@project), title: 'Settings' do
          = icon('cogs fw')
          %span
            Settings

    -# Global shortcut to network page for compatibility
    - if project_nav_tab? :network
      %li.hidden
        = link_to namespace_project_network_path(@project.namespace, @project, current_ref), title: 'Network', class: 'shortcuts-network' do
          Network
