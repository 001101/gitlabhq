%h3.page-title
  Import repositories from github

%hr
%h4
  Select projects you want to import.
  
%table.table.table-bordered.import-jobs
  %thead
    %tr
      %th From GitHub
      %th To GitLab
      %th Status
  %tbody
    - @already_added_projects.each do |repo|
      %tr{id: "repo_#{repo.id}", class: "#{project_status_css_class(repo.import_status)}"}
        %td= repo.import_source
        %td= repo.name_with_namespace
        %td= repo.human_import_status_name
    
    - @repos.each do |repo|
      %tr{id: "repo_#{repo.id}"}
        %td= repo.full_name
        %td.import-target 
          = repo.full_name
        %td.import-actions
          = button_tag "Add", class: "btn btn-add-to-import"
        

:coffeescript
  $(".btn-add-to-import").click () ->
    new_namespace = null
    tr = $(this).closest("tr")
    id = tr.attr("id").replace("repo_", "")
    if tr.find(".import-target input").length > 0
      new_namespace = tr.find(".import-target input").prop("value")
      tr.find(".import-target").empty().append(new_namespace + "/" + tr.find(".import-target").data("project_name"))
    $.post "#{github_import_url}", {repo_id: id, new_namespace: new_namespace}, dataType: 'script'


        
