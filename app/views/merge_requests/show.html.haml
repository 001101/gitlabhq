%div
  %span.entity-info
    - if can?(current_user, :admin_project, @project) || @merge_request.author == current_user
      = link_to edit_project_merge_request_path(@project, @merge_request) do 
        .entity-button
          Edit Merge Request
          %i
  = image_tag gravatar_icon(@merge_request.author_email), :class => "left", :width => 40, :style => "padding-right:5px;"
  %span.commit-title
    %strong
      = "Merge Request ##{@merge_request.id}:"
      &nbsp;
      .tag.commit.inline= @merge_request.source_branch
      &rarr;
      .tag.commit.inline= @merge_request.target_branch
  %span.commit-author
    %strong
      = link_to project_team_member_path(@project, @project.users_projects.find(@merge_request.author.id)) do 
        = @merge_request.author_name
      &rarr;
      = link_to project_team_member_path(@project, @project.users_projects.find(@merge_request.assignee.id)) do 
        = @merge_request.assignee_name

    &nbsp;
    &nbsp;
    = @merge_request.created_at.stamp("Aug 21, 2011 9:23pm")

  %hr
  %h3= @merge_request.title

.clear
%br
%br

.merge-tabs
  = link_to "Notes", "#notes", :class => "merge-notes-tab active"
  = link_to "Commits","#commits", "data-url" => commits_project_merge_request_path(@project, @merge_request), :class => "merge-commits-tab"
  = link_to "Diff", "#diffs", "data-url" => diffs_project_merge_request_path(@project, @merge_request), :class => "merge-diffs-tab"
  - if can?(current_user, :admin_project, @project) || @merge_request.author == current_user
    .right
      - if @merge_request.closed
        = link_to 'Reopen', project_merge_request_path(@project, @merge_request, :merge_request => {:closed => false }, :status_only => true), :method => :put,  :class => "reopen-request"
      - else
        = link_to 'Close', project_merge_request_path(@project, @merge_request, :merge_request => {:closed => true }, :status_only => true), :method => :put, :class => "close-request", :title => "Close merge request"
  %img{:src => "/assets/ajax-loader-facebook.gif", :class => "dashboard-loader"}

.merge-request-notes
  .issue_notes= render "notes/notes"
  .loading{ :style => "display:none;"}
    %center= image_tag "ajax-loader.gif"
  .clear

.merge-request-commits
.merge-request-diffs


:javascript
  $(function(){
    MergeRequest.init();
  })
