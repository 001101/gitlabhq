%h3.page_title
  = "Merge Request ##{@merge_request.id}:"
  &nbsp;
  %span.label_branch= @merge_request.source_branch
  &rarr;
  %span.label_branch= @merge_request.target_branch

  %span.right
    - if @merge_request.merged?
      %span.btn.small.disabled.grouped
        %strong
          %i.icon-ok
          = "MERGED"
    - if can?(current_user, :modify_merge_request, @merge_request)
      - if @merge_request.open?
        = link_to raw_project_merge_request_path(@project, @merge_request), class: "btn grouped" do 
          %i.icon-download-alt
          Get Patch  

        = link_to 'Close', project_merge_request_path(@project, @merge_request, merge_request: {closed: true }, status_only: true), method: :put, class: "btn grouped danger", title: "Close merge request"

        = link_to edit_project_merge_request_path(@project, @merge_request), class: "btn grouped" do
          %i.icon-edit
          Edit

.right
  .span3.votes.votes-block#votes
    .progress
      - up_percent = 100.0/@merge_request.votes_count*@merge_request.upvotes
      - down_percent = 100.0-up_percent
      .bar.bar-success{style: "width: #{up_percent}%;"}
      .bar.bar-danger{style: "width: #{down_percent}%;"}
    .upvotes= "#{@merge_request.upvotes} up"
    .downvotes= "#{@merge_request.downvotes} down"

.back_link
  = link_to project_merge_requests_path(@project) do
    &larr; To merge requests
