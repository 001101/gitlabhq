- page_title "CI Changes"
= render "header_title"

.top-area
  %ul.nav-links
    %li{class: ('active' if @scope.nil? || @scope == 'latest')}
      = link_to project_ci_commits_path(@project, scope: :latest) do
        Latest
        %span.badge.js-totalbuilds-count
          = number_with_delimiter(@all_commits.count(:id))

    %li{class: ('active' if @scope == 'branches')}
      = link_to project_ci_commits_path(@project, scope: :branches) do
        Branches
        %span.badge.js-running-count
          = number_with_delimiter(@all_commits.running_or_pending.count(:id))

    %li{class: ('active' if @scope == 'tags')}
      = link_to project_ci_commits_path(@project, scope: :tags) do
        Tags
        %span.badge.js-running-count
          = number_with_delimiter(@all_commits.running_or_pending.count(:id))

    %li{class: ('active' if @scope == 'failed')}
      = link_to project_ci_commits_path(@project, scope: :failed) do
        Failed
        %span.badge.js-running-count
          = number_with_delimiter(@all_commits.finished.count(:id))

  .nav-controls
    - if can?(current_user, :update_build, @project)
      - unless @repository.gitlab_ci_yml
        = link_to 'Get started with Builds', help_page_path('ci/quick_start', 'README'), class: 'btn btn-info'

      = link_to ci_lint_path, class: 'btn btn-default' do
        = icon('wrench')
        %span CI Lint

.gray-content-block
  #{(@scope || 'running').capitalize} changes on this project

%ul.content-list
  - if @commits.blank?
    %li
      .nothing-here-block No commits to show
  - else
    .table-holder
      %table.table.builds
        = render @commits, commit_sha: true, stage: true, allow_retry: true

    = paginate @commits, theme: 'gitlab'
