- unless @project.empty_repo?
  - if can? current_user, :download_code, @project
    .dropdown.inline.btn-group
      %button.btn{ 'data-toggle' => 'dropdown' }
        = icon('download')
        = icon('caret-down')
        %span.sr-only
          Select Archive Format
      %ul.dropdown-menu.dropdown-menu-align-right{ role: 'menu' }
        %li.dropdown-header Source code
        %li
          = link_to archive_namespace_project_repository_path(@project.namespace, @project, ref: @ref, format: 'zip'), rel: 'nofollow' do
            %span Download zip
        %li
          = link_to archive_namespace_project_repository_path(@project.namespace, @project, ref: @ref, format: 'tar.gz'), rel: 'nofollow' do
            %span Download tar.gz
        - artifacts = @project.builds_for(@ref).latest.with_artifacts
        - if artifacts.any?
          %li.dropdown-header Artifacts
          - artifacts.each do |job|
            %li
              = link_to download_namespace_project_build_artifacts_path(@project.namespace, @project, job), rel: 'nofollow' do
                %span Download '#{job.name}'
