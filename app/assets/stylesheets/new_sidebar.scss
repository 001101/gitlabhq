@import "framework/variables";
@import 'framework/tw_bootstrap_variables';
@import "bootstrap/variables";

$active-background: rgba(0, 0, 0, .04);
$active-border: $indigo-500;
$active-color: $indigo-700;
$active-hover-background: $active-background;
$active-hover-color: $gl-text-color;
$inactive-badge-background: rgba(0, 0, 0, .08);
$hover-background: $indigo-700;
$hover-color: $white-light;
$inactive-color: $gl-text-color-secondary;
$new-sidebar-width: 220px;

.page-with-new-sidebar {
  @media (min-width: $screen-sm-min) {
    padding-left: $new-sidebar-width;
  }

  // Override position: absolute
  .right-sidebar {
    position: fixed;
    height: 100%;
  }
}

.context-header {
  border-bottom: 1px solid $border-color;
  font-weight: 600;
  display: flex;
  align-items: center;
  padding: 10px 16px 10px 10px;
  color: $gl-text-color;

  .avatar-container {
    flex: 0 0 40px;
    background-color: $white-light;
  }

  &:hover {
    background-color: $hover-background;
    color: $hover-color;
    border-color: $hover-background;

    .avatar-container {
      border-color: transparent;
    }

    .settings-avatar {
      background-color: $indigo-500;

      i {
        color: $hover-color;
      }
    }
  }

  .project-title,
  .group-title {
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

.settings-avatar {
  background-color: $white-light;

  i {
    font-size: 20px;
    width: 100%;
    color: $gl-text-color-secondary;
    text-align: center;
    align-self: center;
  }
}

.nav-sidebar {
  position: fixed;
  z-index: 400;
  width: $new-sidebar-width;
  transition: width $sidebar-transition-duration;
  top: 50px;
  bottom: 0;
  left: 0;
  overflow: auto;
  background-color: $gray-normal;
  box-shadow: inset -2px 0 0 $border-color;

  a {
    transition: none;
    text-decoration: none;
  }

  ul {
    padding-left: 0;
    list-style: none;
  }

  li {
    position: relative;
    white-space: nowrap;

    a {
      display: block;
      padding: 12px 16px;
      color: $inactive-color;
    }
  }

  li.active {
    box-shadow: inset 4px 0 0 $active-border;

    > a {
      color: $active-color;
      font-weight: 700;
    }
  }

  @media (max-width: $screen-xs-max) {
    width: 0;
  }
}

.sidebar-sub-level-items {
  display: none;
  padding-bottom: 8px;

  > li {
    &:not(.active) {
      @media (min-width: $screen-sm-min) {
        a {
          padding: 11px 16px 11px 24px;

          &:hover,
          &:focus {
            background: transparent;
            font-weight: 600;
          }
        }
      }
    }

    a {
      padding: 8px 16px 8px 24px;

      &:hover,
      &:focus {
        background: $active-hover-background;
        color: $active-hover-color;
      }
    }

    &.active {
      a {
        &,
        &:hover,
        &:focus {
          background: $active-background;
          color: $active-color;
        }
      }
    }
  }
}

.sidebar-top-level-items {
  > li {
    &:not(.active) {
      .sidebar-sub-level-items {
        @media (min-width: $screen-sm-min) {
          position: fixed;
          left: 220px;
          width: 150px;
          margin-left: -1px;
          padding-bottom: 0;
          background-color: #fff;
          box-shadow: 2px 1px 3px rgba(0,0,0,.1);
          border: 1px solid #e5e5e5;
          border-left: 0;

          &::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 21px 12px;
            border-color: transparent transparent transparent $hover-background;
          }
        }
      }
    }

    .badge {
      float: right;
      background-color: $inactive-badge-background;
      color: $inactive-color;
    }

    &.active {
      background: $active-background;

      .badge {
        color: $active-color;
        font-weight: 600;
      }

      .sidebar-sub-level-items {
        display: block;
      }
    }

    &:not(.active):hover > a,
    > a:hover {
      background-color: $hover-background;
      color: $hover-color;

      .badge {
        background-color: $indigo-500;
        color: $hover-color;
      }
    }
  }
}


// Make issue boards full-height now that sub-nav is gone

.boards-list {
  height: calc(100vh - 50px);

  @media (min-width: $screen-sm-min) {
    height: 475px; // Needed for PhantomJS
    // scss-lint:disable DuplicateProperty
    height: calc(100vh - 120px);
    // scss-lint:enable DuplicateProperty
  }
}


// Change color of all horizontal tabs to match the new indigo color
.nav-links li.active a {
  border-bottom-color: $active-border;

  .badge {
    font-weight: 600;
  }
}
