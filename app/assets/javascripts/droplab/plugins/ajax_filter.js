!function(n){function e(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return n[a].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var t={};e.m=n,e.c=t,e.i=function(n){return n},e.d=function(n,t,a){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:a})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},e.p="",e(e.s=11)}({11:function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar droplabAjaxFilter = {\n  init: function init(hook) {\n    this.destroyed = false;\n    this.hook = hook;\n    this.notLoading();\n\n    this.eventWrapper = {};\n    this.eventWrapper.debounceTrigger = this.debounceTrigger.bind(this);\n    this.hook.trigger.addEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.addEventListener('focus', this.eventWrapper.debounceTrigger);\n\n    this.trigger(true);\n  },\n\n  notLoading: function notLoading() {\n    this.loading = false;\n  },\n\n  debounceTrigger: function debounceTrigger(e) {\n    var NON_CHARACTER_KEYS = [16, 17, 18, 20, 37, 38, 39, 40, 91, 93];\n    var invalidKeyPressed = NON_CHARACTER_KEYS.indexOf(e.detail.which || e.detail.keyCode) > -1;\n    var focusEvent = e.type === 'focus';\n    if (invalidKeyPressed || this.loading) {\n      return;\n    }\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n    this.timeout = setTimeout(this.trigger.bind(this, focusEvent), 200);\n  },\n\n  trigger: function trigger(getEntireList) {\n    var config = this.hook.config.droplabAjaxFilter;\n    var searchValue = this.trigger.value;\n    if (!config || !config.endpoint || !config.searchKey) {\n      return;\n    }\n    if (config.searchValueFunction) {\n      searchValue = config.searchValueFunction();\n    }\n    if (config.loadingTemplate && this.hook.list.data === undefined || this.hook.list.data.length === 0) {\n      var dynamicList = this.hook.list.list.querySelector('[data-dynamic]');\n      var loadingTemplate = document.createElement('div');\n      loadingTemplate.innerHTML = config.loadingTemplate;\n      loadingTemplate.setAttribute('data-loading-template', true);\n      this.listTemplate = dynamicList.outerHTML;\n      dynamicList.outerHTML = loadingTemplate.outerHTML;\n    }\n    if (getEntireList) {\n      searchValue = '';\n    }\n    if (config.searchKey === searchValue) {\n      return this.list.show();\n    }\n    this.loading = true;\n    var params = config.params || {};\n    params[config.searchKey] = searchValue;\n    var self = this;\n    self.cache = self.cache || {};\n    var url = config.endpoint + this.buildParams(params);\n    var urlCachedData = self.cache[url];\n    if (urlCachedData) {\n      self._loadData(urlCachedData, config, self);\n    } else {\n      this._loadUrlData(url).then(function (data) {\n        self._loadData(data, config, self);\n      });\n    }\n  },\n\n  _loadUrlData: function _loadUrlData(url) {\n    var self = this;\n    return new Promise(function (resolve, reject) {\n      var xhr = new XMLHttpRequest();\n      xhr.open('GET', url, true);\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === XMLHttpRequest.DONE) {\n          if (xhr.status === 200) {\n            var data = JSON.parse(xhr.responseText);\n            self.cache[url] = data;\n            return resolve(data);\n          } else {\n            return reject([xhr.responseText, xhr.status]);\n          }\n        }\n      };\n      xhr.send();\n    });\n  },\n\n  _loadData: function _loadData(data, config, self) {\n    var list = self.hook.list;\n    if (config.loadingTemplate && list.data === undefined || list.data.length === 0) {\n      var dataLoadingTemplate = list.list.querySelector('[data-loading-template]');\n      if (dataLoadingTemplate) {\n        dataLoadingTemplate.outerHTML = self.listTemplate;\n      }\n    }\n    if (!self.destroyed) {\n      var hookListChildren = list.list.children;\n      var onlyDynamicList = hookListChildren.length === 1 && hookListChildren[0].hasAttribute('data-dynamic');\n      if (onlyDynamicList && data.length === 0) {\n        list.hide();\n      }\n      list.setData.call(list, data);\n    }\n    self.notLoading();\n    list.currentIndex = 0;\n  },\n\n  buildParams: function buildParams(params) {\n    if (!params) return '';\n    var paramsArray = Object.keys(params).map(function (param) {\n      return param + '=' + (params[param] || '');\n    });\n    return '?' + paramsArray.join('&');\n  },\n\n  destroy: function destroy() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    this.destroyed = true;\n    this.hook.trigger.removeEventListener('keydown.dl', this.eventWrapper.debounceTrigger);\n    this.hook.trigger.removeEventListener('focus', this.eventWrapper.debounceTrigger);\n  }\n};\n\nwindow.droplabAjaxFilter = droplabAjaxFilter;\n\nexports.default = droplabAjaxFilter;\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/plugins/ajax_filter.js\n// module id = 11\n// module chunks = 2\n\n//# sourceURL=webpack:///./src/plugins/ajax_filter.js?")}});